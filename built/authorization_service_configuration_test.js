"use strict";
/*
 * Copyright 2017 Google Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License"); you may not use this file except
 * in compliance with the License. You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software distributed under the
 * License is distributed on an "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either
 * express or implied. See the License for the specific language governing permissions and
 * limitations under the License.
 */
Object.defineProperty(exports, "__esModule", { value: true });
var authorization_service_configuration_1 = require("./authorization_service_configuration");
var xhr_1 = require("./xhr");
describe('Authorization Service Configuration Tests', function () {
    var authorizationEndpoint = 'authorization://endpoint';
    var tokenEndpoint = 'token://endpoint';
    var revocationEndpoint = 'revocation://endpoint';
    var endSessionEndpoint = 'endSession://endpoint';
    var userInfoEndpoint = 'userInfo://endpoint';
    it('Initialization should work', function () {
        var configuration = new authorization_service_configuration_1.AuthorizationServiceConfiguration(authorizationEndpoint, tokenEndpoint, revocationEndpoint, endSessionEndpoint, userInfoEndpoint);
        expect(configuration).toBeTruthy();
        expect(configuration.authorizationEndpoint).toBe(authorizationEndpoint);
        expect(configuration.tokenEndpoint).toBe(tokenEndpoint);
        expect(configuration.revocationEndpoint).toBe(revocationEndpoint);
        expect(configuration.endSessionEndpoint).toBe(endSessionEndpoint);
        expect(configuration.userInfoEndpoint).toBe(userInfoEndpoint);
    });
    it('Conversion to Json and back should work', function () {
        var configuration = new authorization_service_configuration_1.AuthorizationServiceConfiguration(authorizationEndpoint, tokenEndpoint, revocationEndpoint, endSessionEndpoint, userInfoEndpoint);
        var json = configuration.toJson();
        var newConfiguration = authorization_service_configuration_1.AuthorizationServiceConfiguration.fromJson(json);
        expect(newConfiguration).toBeTruthy();
        expect(newConfiguration.authorizationEndpoint).toBe(configuration.authorizationEndpoint);
        expect(newConfiguration.tokenEndpoint).toBe(configuration.tokenEndpoint);
        expect(newConfiguration.revocationEndpoint).toBe(configuration.revocationEndpoint);
        expect(configuration.endSessionEndpoint).toBe(endSessionEndpoint);
        expect(configuration.userInfoEndpoint).toBe(userInfoEndpoint);
    });
    describe('Tests with dependencies', function () {
        it('Fetch from issuer tests should work', function (done) {
            var configuration = new authorization_service_configuration_1.AuthorizationServiceConfiguration(authorizationEndpoint, tokenEndpoint, revocationEndpoint, endSessionEndpoint, userInfoEndpoint);
            var promise = Promise.resolve(configuration.toJson());
            var requestor = new xhr_1.TestRequestor(promise);
            authorization_service_configuration_1.AuthorizationServiceConfiguration.fetchFromIssuer('some://endpoint', requestor)
                .then(function (result) {
                expect(result).toBeTruthy();
                expect(result.authorizationEndpoint).toBe(configuration.authorizationEndpoint);
                expect(result.tokenEndpoint).toBe(configuration.tokenEndpoint);
                expect(result.revocationEndpoint).toBe(configuration.revocationEndpoint);
                expect(configuration.endSessionEndpoint).toBe(endSessionEndpoint);
                expect(configuration.userInfoEndpoint).toBe(userInfoEndpoint);
                done();
            });
        });
        it('Fetch from issuer tests should work', function (done) {
            var promise = Promise.reject(new Error('Something bad happened.'));
            var requestor = new xhr_1.TestRequestor(promise);
            authorization_service_configuration_1.AuthorizationServiceConfiguration.fetchFromIssuer('some://endpoint', requestor)
                .catch(function (result) {
                expect(result).toBeTruthy();
                var error = result;
                expect(error.message).toBe('Something bad happened.');
                done();
            });
        });
    });
});
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiYXV0aG9yaXphdGlvbl9zZXJ2aWNlX2NvbmZpZ3VyYXRpb25fdGVzdC5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIi4uL3NyYy9hdXRob3JpemF0aW9uX3NlcnZpY2VfY29uZmlndXJhdGlvbl90ZXN0LnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7QUFBQTs7Ozs7Ozs7Ozs7O0dBWUc7O0FBRUgsNkZBQStIO0FBRS9ILDZCQUFvQztBQUVwQyxRQUFRLENBQUMsMkNBQTJDLEVBQUU7SUFDcEQsSUFBTSxxQkFBcUIsR0FBRywwQkFBMEIsQ0FBQTtJQUN4RCxJQUFNLGFBQWEsR0FBRyxrQkFBa0IsQ0FBQztJQUN6QyxJQUFNLGtCQUFrQixHQUFHLHVCQUF1QixDQUFDO0lBQ25ELElBQU0sa0JBQWtCLEdBQUcsdUJBQXVCLENBQUM7SUFDbkQsSUFBTSxnQkFBZ0IsR0FBRyxxQkFBcUIsQ0FBQztJQUUvQyxFQUFFLENBQUMsNEJBQTRCLEVBQUU7UUFDL0IsSUFBSSxhQUFhLEdBQUcsSUFBSSx1RUFBaUMsQ0FDckQscUJBQXFCLEVBQ3JCLGFBQWEsRUFDYixrQkFBa0IsRUFDbEIsa0JBQWtCLEVBQ2xCLGdCQUFnQixDQUFDLENBQUM7UUFFdEIsTUFBTSxDQUFDLGFBQWEsQ0FBQyxDQUFDLFVBQVUsRUFBRSxDQUFDO1FBQ25DLE1BQU0sQ0FBQyxhQUFhLENBQUMscUJBQXFCLENBQUMsQ0FBQyxJQUFJLENBQUMscUJBQXFCLENBQUMsQ0FBQztRQUN4RSxNQUFNLENBQUMsYUFBYSxDQUFDLGFBQWEsQ0FBQyxDQUFDLElBQUksQ0FBQyxhQUFhLENBQUMsQ0FBQztRQUN4RCxNQUFNLENBQUMsYUFBYSxDQUFDLGtCQUFrQixDQUFDLENBQUMsSUFBSSxDQUFDLGtCQUFrQixDQUFDLENBQUM7UUFDbEUsTUFBTSxDQUFDLGFBQWEsQ0FBQyxrQkFBa0IsQ0FBQyxDQUFDLElBQUksQ0FBQyxrQkFBa0IsQ0FBQyxDQUFDO1FBQ2xFLE1BQU0sQ0FBQyxhQUFhLENBQUMs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QWUsQ0FBQyxpQkFBaUIsRUFBRSxTQUFTLENBQUM7aUJBQzFFLEtBQUssQ0FBQyxVQUFBLE1BQU07Z0JBQ1gsTUFBTSxDQUFDLE1BQU0sQ0FBQyxDQUFDLFVBQVUsRUFBRSxDQUFDO2dCQUM1QixJQUFJLEtBQUssR0FBRyxNQUFzQixDQUFDO2dCQUNuQyxNQUFNLENBQUMsS0FBSyxDQUFDLE9BQU8sQ0FBQyxDQUFDLElBQUksQ0FBQyx5QkFBeUIsQ0FBQyxDQUFDO2dCQUN0RCxJQUFJLEVBQUUsQ0FBQztZQUNULENBQUMsQ0FBQyxDQUFDO1FBQ1QsQ0FBQyxDQUFDLENBQUM7SUFDTCxDQUFDLENBQUMsQ0FBQztBQUNMLENBQUMsQ0FBQyxDQUFDIiwic291cmNlc0NvbnRlbnQiOlsiLypcclxuICogQ29weXJpZ2h0IDIwMTcgR29vZ2xlIEluYy5cclxuICpcclxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTsgeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHRcclxuICogaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcclxuICpcclxuICogaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXHJcbiAqXHJcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmUgZGlzdHJpYnV0ZWQgdW5kZXIgdGhlXHJcbiAqIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLCBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyXHJcbiAqIGV4cHJlc3Mgb3IgaW1wbGllZC4gU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxyXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cclxuICovXHJcblxyXG5pbXBvcnQge0F1dGhvcml6YXRpb25TZXJ2aWNlQ29uZmlndXJhdGlvbiwgQXV0aG9yaXphdGlvblNlcnZpY2VDb25maWd1cmF0aW9uSnNvbn0gZnJvbSAnLi9hdXRob3JpemF0aW9uX3NlcnZpY2VfY29uZmlndXJhdGlvbic7XHJcbmltcG9ydCB7QXBwQXV0aEVycm9yfSBmcm9tICcuL2Vycm9ycyc7XHJcbmltcG9ydCB7VGVzdFJlcXVlc3Rvcn0gZnJvbSAnLi94aHInO1xyXG5cclxuZGVzY3JpYmUoJ0F1dGhvcml6YXRpb24gU2VydmljZSBDb25maWd1cmF0aW9uIFRlc3RzJywgKCkgPT4ge1xyXG4gIGNvbnN0IGF1dGhvcml6YXRpb25FbmRwb2ludCA9ICdhdXRob3JpemF0aW9uOi8vZW5kcG9pbnQnXHJcbiAgY29uc3QgdG9rZW5FbmRwb2ludCA9ICd0b2tlbjovL2VuZHBvaW50JztcclxuICBjb25zdCByZXZvY2F0aW9uRW5kcG9pbnQgPSAncmV2b2NhdGlvbjovL2VuZHBvaW50JztcclxuICBjb25zdCBlbmRTZXNzaW9uRW5kcG9pbnQgPSAnZW5kU2Vzc2lvbjovL2VuZHBvaW50JztcclxuICBjb25zdCB1c2VySW5mb0VuZHBvaW50ID0gJ3VzZXJJbmZvOi8vZW5kcG9pbnQnO1xyXG5cclxuICBpdCgnSW5pdGlhbGl6YXRpb24gc2hvdWxkIHdvcmsnLCAoKSA9PiB7XHJcbiAgICBsZXQgY29uZmlndXJhdGlvbiA9IG5ldyBBdXRob3JpemF0aW9uU2VydmljZUNvbmZpZ3VyYXRpb24oXHJcbiAgICAgICAgYXV0aG9yaXphdGlvbkVuZHBvaW50LFxyXG4gICAgICAgIHRva2VuRW5kcG9pbnQsXHJcbiAgICAgICAgcmV2b2NhdGlvbkVuZHBvaW50LFxyXG4gICAgICAgIGVuZFNlc3Npb25FbmRwb2ludCxcclxuICAgICAgICB1c2VySW5mb0VuZHBvaW50KTtcclxuXHJcbiAgICBleHBlY3QoY29uZmlndXJhdGlvbikudG9CZVRydXRoeSgpO1xyXG4gICAgZXhwZWN0KGNvbmZpZ3VyYXRpb24uYXV0aG9yaXphdGlvbkVuZHBvaW50KS50b0JlKGF1dGhvcml6YXRpb25FbmRwb2ludCk7XHJcbiAgICBleHBlY3QoY29uZmlndXJhdGlvbi50b2tlbkVuZHBvaW50KS50b0JlKHRva2VuRW5kcG9pbnQpO1xyXG4gICAgZXhwZWN0KGNvbmZpZ3VyYXRpb24ucmV2b2NhdGlvbkVuZHBvaW50KS50b0JlKHJldm9jYXRpb25FbmRwb2ludCk7XHJcbiAgICBleHBlY3QoY29uZmlndXJhdGlvbi5lbmRTZXNzaW9uRW5kcG9pbnQpLnRvQmUoZW5kU2Vzc2lvbkVuZHBvaW50KTtcclxuICAgIGV4cGVjdChjb25maWd1cmF0aW9uLnVzZXJJbmZvRW5kcG9pbnQpLnRvQmUodXNlckluZm9FbmRwb2ludCk7XHJcbiAgfSk7XHJcblxyXG4gIGl0KCdDb252ZXJzaW9uIHRvIEpzb24gYW5kIGJhY2sgc2hvdWxkIHdvcmsnLCAoKSA9PiB7XHJcbiAgICBsZXQgY29uZmlndXJhdGlvbiA9IG5ldyBBdXRob3JpemF0aW9uU2VydmljZUNvbmZpZ3VyYXRpb24oXHJcbiAgICAgICAgYXV0aG9yaXphdGlvbkVuZHBvaW50LFxyXG4gICAgICAgIHRva2VuRW5kcG9pbnQsXHJcbiAgICAgICAgcmV2b2NhdGlvbkVuZHBvaW50LFxyXG4gICAgICAgIGVuZFNlc3Npb25FbmRwb2ludCxcclxuICAgICAgICB1c2VySW5mb0VuZHBvaW50KTtcclxuXHJcbiAgICBsZXQganNvbiA9IGNvbmZpZ3VyYXRpb24udG9Kc29uKCk7XHJcbiAgICBsZXQgbmV3Q29uZmlndXJhdGlvbiA9IEF1dGhvcml6YXRpb25TZXJ2aWNlQ29uZmlndXJhdGlvbi5mcm9tSnNvbihqc29uKTtcclxuICAgIGV4cGVjdChuZXdDb25maWd1cmF0aW9uKS50b0JlVHJ1dGh5KCk7XHJcbiAgICBleHBlY3QobmV3Q29uZmlndXJhdGlvbi5hdXRob3JpemF0aW9uRW5kcG9pbnQpLnRvQmUoY29uZmlndXJhdGlvbi5hdXRob3JpemF0aW9uRW5kcG9pbnQpO1xyXG4gICAgZXhwZWN0KG5ld0NvbmZpZ3VyYXRpb24udG9rZW5FbmRwb2ludCkudG9CZShjb25maWd1cmF0aW9uLnRva2VuRW5kcG9pbnQpO1xyXG4gICAgZXhwZWN0KG5ld0NvbmZpZ3VyYXRpb24ucmV2b2NhdGlvbkVuZHBvaW50KS50b0JlKGNvbmZpZ3VyYXRpb24ucmV2b2NhdGlvbkVuZHBvaW50KTtcclxuICAgIGV4cGVjdChjb25maWd1cmF0aW9uLmVuZFNlc3Npb25FbmRwb2ludCkudG9CZShlbmRTZXNzaW9uRW5kcG9pbnQpO1xyXG4gICAgZXhwZWN0KGNvbmZpZ3VyYXRpb24udXNlckluZm9FbmRwb2ludCkudG9CZSh1c2VySW5mb0VuZHBvaW50KTtcclxuICB9KTtcclxuXHJcbiAgZGVzY3JpYmUoJ1Rlc3RzIHdpdGggZGVwZW5kZW5jaWVzJywgKCkgPT4ge1xyXG4gICAgaXQoJ0ZldGNoIGZyb20gaXNzdWVyIHRlc3RzIHNob3VsZCB3b3JrJywgKGRvbmU6IERvbmVGbikgPT4ge1xyXG4gICAgICBsZXQgY29uZmlndXJhdGlvbiA9IG5ldyBBdXRob3JpemF0aW9uU2VydmljZUNvbmZpZ3VyYXRpb24oXHJcbiAgICAgICAgICBhdXRob3JpemF0aW9uRW5kcG9pbnQsXHJcbiAgICAgICAgICB0b2tlbkVuZHBvaW50LFxyXG4gICAgICAgICAgcmV2b2NhdGlvbkVuZHBvaW50LFxyXG4gICAgICAgICAgZW5kU2Vzc2lvbkVuZHBvaW50LFxyXG4gICAgICAgICAgdXNlckluZm9FbmRwb2ludCk7XHJcblxyXG4gICAgICBsZXQgcHJvbWlzZTogUHJvbWlzZTxBdXRob3JpemF0aW9uU2VydmljZUNvbmZpZ3VyYXRpb25Kc29uPiA9XHJcbiAgICAgICAgICBQcm9taXNlLnJlc29sdmUoY29uZmlndXJhdGlvbi50b0pzb24oKSk7XHJcbiAgICAgIGxldCByZXF1ZXN0b3IgPSBuZXcgVGVzdFJlcXVlc3Rvcihwcm9taXNlKTtcclxuICAgICAgQXV0aG9yaXphdGlvblNlcnZpY2VDb25maWd1cmF0aW9uLmZldGNoRnJvbUlzc3Vlcignc29tZTovL2VuZHBvaW50JywgcmVxdWVzdG9yKVxyXG4gICAgICAgICAgLnRoZW4ocmVzdWx0ID0+IHtcclxuICAgICAgICAgICAgZXhwZWN0KHJlc3VsdCkudG9CZVRydXRoeSgpO1xyXG4gICAgICAgICAgICBleHBlY3QocmVzdWx0LmF1dGhvcml6YXRpb25FbmRwb2ludCkudG9CZShjb25maWd1cmF0aW9uLmF1dGhvcml6YXRpb25FbmRwb2ludCk7XHJcbiAgICAgICAgICAgIGV4cGVjdChyZXN1bHQudG9rZW5FbmRwb2ludCkudG9CZShjb25maWd1cmF0aW9uLnRva2VuRW5kcG9pbnQpO1xyXG4gICAgICAgICAgICBleHBlY3QocmVzdWx0LnJldm9jYXRpb25FbmRwb2ludCkudG9CZShjb25maWd1cmF0aW9uLnJldm9jYXRpb25FbmRwb2ludCk7XHJcbiAgICAgICAgICAgIGV4cGVjdChjb25maWd1cmF0aW9uLmVuZFNlc3Npb25FbmRwb2ludCkudG9CZShlbmRTZXNzaW9uRW5kcG9pbnQpO1xyXG4gICAgICAgICAgICBleHBlY3QoY29uZmlndXJhdGlvbi51c2VySW5mb0VuZHBvaW50KS50b0JlKHVzZXJJbmZvRW5kcG9pbnQpO1xyXG4gICAgICAgICAgICBkb25lKCk7XHJcbiAgICAgICAgICB9KTtcclxuICAgIH0pO1xyXG5cclxuICAgIGl0KCdGZXRjaCBmcm9tIGlzc3VlciB0ZXN0cyBzaG91bGQgd29yaycsIChkb25lOiBEb25lRm4pID0+IHtcclxuICAgICAgbGV0IHByb21pc2U6IFByb21pc2U8QXV0aG9yaXphdGlvblNlcnZpY2VDb25maWd1cmF0aW9uSnNvbj4gPVxyXG4gICAgICAgICAgUHJvbWlzZS5yZWplY3QobmV3IEVycm9yKCdTb21ldGhpbmcgYmFkIGhhcHBlbmVkLicpKTtcclxuICAgICAgbGV0IHJlcXVlc3RvciA9IG5ldyBUZXN0UmVxdWVzdG9yKHByb21pc2UpO1xyXG5cclxuICAgICAgQXV0aG9yaXphdGlvblNlcnZpY2VDb25maWd1cmF0aW9uLmZldGNoRnJvbUlzc3Vlcignc29tZTovL2VuZHBvaW50JywgcmVxdWVzdG9yKVxyXG4gICAgICAgICAgLmNhdGNoKHJlc3VsdCA9PiB7XHJcbiAgICAgICAgICAgIGV4cGVjdChyZXN1bHQpLnRvQmVUcnV0aHkoKTtcclxuICAgICAgICAgICAgbGV0IGVycm9yID0gcmVzdWx0IGFzIEFwcEF1dGhFcnJvcjtcclxuICAgICAgICAgICAgZXhwZWN0KGVycm9yLm1lc3NhZ2UpLnRvQmUoJ1NvbWV0aGluZyBiYWQgaGFwcGVuZWQuJyk7XHJcbiAgICAgICAgICAgIGRvbmUoKTtcclxuICAgICAgICAgIH0pO1xyXG4gICAgfSk7XHJcbiAgfSk7XHJcbn0pO1xyXG4iXX0=