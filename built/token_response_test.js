"use strict";
/*
 * Copyright 2017 Google Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License"); you may not use this file except
 * in compliance with the License. You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software distributed under the
 * License is distributed on an "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either
 * express or implied. See the License for the specific language governing permissions and
 * limitations under the License.
 */
Object.defineProperty(exports, "__esModule", { value: true });
var token_response_1 = require("./token_response");
describe('Token Response tests', function () {
    var accessToken = 'accessToken';
    var idToken = 'idToken';
    var refreshToken = 'refreshToken';
    it('Basic Token Response Tests', function () {
        var response = new token_response_1.TokenResponse({ access_token: accessToken });
        expect(response).not.toBeNull();
        expect(response.accessToken).toBe(accessToken);
        expect(response.idToken).toBeFalsy();
        expect(response.tokenType).toBe('bearer');
        expect(response.issuedAt).toBeTruthy();
        expect(response.isValid()).toBe(true);
        expect(response.refreshToken).toBeFalsy();
        expect(response.scope).toBeFalsy();
    });
    it('Test response token validity', function () {
        var response = new token_response_1.TokenResponse({
            access_token: accessToken,
            token_type: 'bearer',
            expires_in: '1000',
            refresh_token: undefined,
            scope: undefined,
            id_token: idToken,
            issued_at: 1
        });
        expect(response).not.toBeNull();
        expect(response.accessToken).toBe(accessToken);
        expect(response.idToken).toBe(idToken);
        expect(response.tokenType).toBe('bearer');
        expect(response.issuedAt).toBeTruthy();
        expect(response.isValid(0)).toBe(false);
        expect(response.refreshToken).toBeFalsy();
        expect(response.scope).toBeFalsy();
    });
    it('Test response refresh token validity', function () {
        var response = new token_response_1.TokenResponse({
            access_token: accessToken,
            token_type: 'bearer',
            expires_in: '300',
            refresh_token: refreshToken,
            refresh_expires_in: '1800',
            scope: undefined,
            id_token: idToken,
            issued_at: 1
        });
        expect(response).not.toBeNull();
        expect(response.accessToken).toBe(accessToken);
        expect(response.idToken).toBe(idToken);
        expect(response.tokenType).toBe('bearer');
        expect(response.issuedAt).toBeTruthy();
        expect(response.isValid(0)).toBe(false);
        expect(response.refreshToken).toBe(refreshToken);
        expect(response.isRefreshTokenValid(0)).toBe(false);
        expect(response.scope).toBeFalsy();
    });
    it('To Json() and from Json() should work', function () {
        var response = new token_response_1.TokenResponse({ access_token: accessToken, id_token: idToken });
        var json = JSON.parse(JSON.stringify(response.toJson()));
        var newResponse = new token_response_1.TokenResponse(json);
        expect(newResponse).not.toBeNull();
        expect(newResponse.accessToken).toBe(accessToken);
        expect(newResponse.idToken).toBe(idToken);
        expect(newResponse.tokenType).toBe('bearer');
        expect(newResponse.issuedAt).toBeTruthy();
        expect(newResponse.isValid()).toBe(true);
        expect(newResponse.refreshToken).toBeFalsy();
        expect(newResponse.scope).toBeFalsy();
    });
    it('Basic Token Error Tests', function () {
        var error = new token_response_1.TokenError({ error: 'invalid_client' });
        expect(error).toBeTruthy();
        expect(error.error).toBe('invalid_client');
        expect(error.errorDescription).toBeFalsy();
        expect(error.errorUri).toBeFalsy();
    });
    it('To Json and from JSON should work for errors', function () {
        var error = new token_response_1.TokenError({ error: 'invalid_client' });
        var json = JSON.parse(JSON.stringify(error.toJson()));
        var newError = new token_response_1.TokenError(json);
        expect(newError).toBeTruthy();
        expect(newError.error).toBe('invalid_client');
        expect(newError.errorDescription).toBeFalsy();
        expect(newError.errorUri).toBeFalsy();
    });
});
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoidG9rZW5fcmVzcG9uc2VfdGVzdC5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIi4uL3NyYy90b2tlbl9yZXNwb25zZV90ZXN0LnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7QUFBQTs7Ozs7Ozs7Ozs7O0dBWUc7O0FBRUgsbURBQTJEO0FBRTNELFFBQVEsQ0FBQyxzQkFBc0IsRUFBRTtJQUMvQixJQUFNLFdBQVcsR0FBRyxhQUFhLENBQUM7SUFDbEMsSUFBTSxPQUFPLEdBQUcsU0FBUyxDQUFDO0lBQzFCLElBQU0sWUFBWSxHQUFHLGNBQWMsQ0FBQztJQUVwQyxFQUFFLENBQUMsNEJBQTRCLEVBQUU7UUFDL0IsSUFBSSxRQUFRLEdBQUcsSUFBSSw4QkFBYSxDQUFDLEVBQUMsWUFBWSxFQUFFLFdBQVcsRUFBQyxDQUFDLENBQUM7UUFDOUQsTUFBTSxDQUFDLFFBQVEsQ0FBQyxDQUFDLEdBQUcsQ0FBQyxRQUFRLEVBQUUsQ0FBQztRQUNoQyxNQUFNLENBQUMsUUFBUSxDQUFDLFdBQVcsQ0FBQyxDQUFDLElBQUksQ0FBQyxXQUFXLENBQUMsQ0FBQztRQUMvQyxNQUFNLENBQUMsUUFBUSxDQUFDLE9BQU8sQ0FBQyxDQUFDLFNBQVMsRUFBRSxDQUFDO1FBQ3JDLE1BQU0sQ0FBQyxRQUFRLENBQUMsU0FBUyxDQUFDLENBQUMsSUFBSSxDQUFDLFFBQVEsQ0FBQyxDQUFDO1FBQzFDLE1BQU0sQ0FBQyxRQUFRLENBQUMsUUFBUSxDQUFDLENBQUMsVUFBVSxFQUFFLENBQUM7UUFDdkMsTUFBTSxDQUFDLFFBQVEsQ0FBQyxPQUFPLEVBQUUsQ0FBQyxDQUFDLElBQUksQ0FBQyxJQUFJLENBQUMsQ0FBQztRQUN0QyxNQUFNLENBQUMsUUFBUSxDQUFDLFlBQVksQ0FBQyxDQUFDLFNBQVMsRUFBRSxDQUFDO1FBQzFDLE1BQU0sQ0FBQyxRQUFRLENBQUMsS0FBSyxDQUFDLENBQUMsU0FBUyxFQUFFLENBQUM7SUFDckMsQ0FBQyxDQUFDLENBQUM7SUFFSCxFQUFFLENB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UyxFQUFFLENBQUM7SUFDckMsQ0FBQyxDQUFDLENBQUM7SUFFSCxFQUFFLENBQUMsOENBQThDLEVBQUU7UUFDakQsSUFBSSxLQUFLLEdBQUcsSUFBSSwyQkFBVSxDQUFDLEVBQUMsS0FBSyxFQUFFLGdCQUFnQixFQUFDLENBQUMsQ0FBQztRQUN0RCxJQUFJLElBQUksR0FBRyxJQUFJLENBQUMsS0FBSyxDQUFDLElBQUksQ0FBQyxTQUFTLENBQUMsS0FBSyxDQUFDLE1BQU0sRUFBRSxDQUFDLENBQUMsQ0FBQztRQUN0RCxJQUFJLFFBQVEsR0FBRyxJQUFJLDJCQUFVLENBQUMsSUFBSSxDQUFDLENBQUM7UUFDcEMsTUFBTSxDQUFDLFFBQVEsQ0FBQyxDQUFDLFVBQVUsRUFBRSxDQUFDO1FBQzlCLE1BQU0sQ0FBQyxRQUFRLENBQUMsS0FBSyxDQUFDLENBQUMsSUFBSSxDQUFDLGdCQUFnQixDQUFDLENBQUM7UUFDOUMsTUFBTSxDQUFDLFFBQVEsQ0FBQyxnQkFBZ0IsQ0FBQyxDQUFDLFNBQVMsRUFBRSxDQUFDO1FBQzlDLE1BQU0sQ0FBQyxRQUFRLENBQUMsUUFBUSxDQUFDLENBQUMsU0FBUyxFQUFFLENBQUM7SUFDeEMsQ0FBQyxDQUFDLENBQUM7QUFDTCxDQUFDLENBQUMsQ0FBQyIsInNvdXJjZXNDb250ZW50IjpbIi8qXG4gKiBDb3B5cmlnaHQgMjAxNyBHb29nbGUgSW5jLlxuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7IHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0XG4gKiBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmUgZGlzdHJpYnV0ZWQgdW5kZXIgdGhlXG4gKiBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUywgV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlclxuICogZXhwcmVzcyBvciBpbXBsaWVkLiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuXG5pbXBvcnQge1Rva2VuRXJyb3IsIFRva2VuUmVzcG9uc2V9IGZyb20gJy4vdG9rZW5fcmVzcG9uc2UnO1xuXG5kZXNjcmliZSgnVG9rZW4gUmVzcG9uc2UgdGVzdHMnLCAoKSA9PiB7XG4gIGNvbnN0IGFjY2Vzc1Rva2VuID0gJ2FjY2Vzc1Rva2VuJztcbiAgY29uc3QgaWRUb2tlbiA9ICdpZFRva2VuJztcbiAgY29uc3QgcmVmcmVzaFRva2VuID0gJ3JlZnJlc2hUb2tlbic7XG5cbiAgaXQoJ0Jhc2ljIFRva2VuIFJlc3BvbnNlIFRlc3RzJywgKCkgPT4ge1xuICAgIGxldCByZXNwb25zZSA9IG5ldyBUb2tlblJlc3BvbnNlKHthY2Nlc3NfdG9rZW46IGFjY2Vzc1Rva2VufSk7XG4gICAgZXhwZWN0KHJlc3BvbnNlKS5ub3QudG9CZU51bGwoKTtcbiAgICBleHBlY3QocmVzcG9uc2UuYWNjZXNzVG9rZW4pLnRvQmUoYWNjZXNzVG9rZW4pO1xuICAgIGV4cGVjdChyZXNwb25zZS5pZFRva2VuKS50b0JlRmFsc3koKTtcbiAgICBleHBlY3QocmVzcG9uc2UudG9rZW5UeXBlKS50b0JlKCdiZWFyZXInKTtcbiAgICBleHBlY3QocmVzcG9uc2UuaXNzdWVkQXQpLnRvQmVUcnV0aHkoKTtcbiAgICBleHBlY3QocmVzcG9uc2UuaXNWYWxpZCgpKS50b0JlKHRydWUpO1xuICAgIGV4cGVjdChyZXNwb25zZS5yZWZyZXNoVG9rZW4pLnRvQmVGYWxzeSgpO1xuICAgIGV4cGVjdChyZXNwb25zZS5zY29wZSkudG9CZUZhbHN5KCk7XG4gIH0pO1xuXG4gIGl0KCdUZXN0IHJlc3BvbnNlIHRva2VuIHZhbGlkaXR5JywgKCkgPT4ge1xuICAgIGxldCByZXNwb25zZSA9IG5ldyBUb2tlblJlc3BvbnNlKHtcbiAgICAgIGFjY2Vzc190b2tlbjogYWNjZXNzVG9rZW4sXG4gICAgICB0b2tlbl90eXBlOiAnYmVhcmVyJyxcbiAgICAgIGV4cGlyZXNfaW46ICcxMDAwJyxcbiAgICAgIHJlZnJlc2hfdG9rZW46IHVuZGVmaW5lZCxcbiAgICAgIHNjb3BlOiB1bmRlZmluZWQsXG4gICAgICBpZF90b2tlbjogaWRUb2tlbixcbiAgICAgIGlzc3VlZF9hdDogMVxuICAgIH0pO1xuXG4gICAgZXhwZWN0KHJlc3BvbnNlKS5ub3QudG9CZU51bGwoKTtcbiAgICBleHBlY3QocmVzcG9uc2UuYWNjZXNzVG9rZW4pLnRvQmUoYWNjZXNzVG9rZW4pO1xuICAgIGV4cGVjdChyZXNwb25zZS5pZFRva2VuKS50b0JlKGlkVG9rZW4pO1xuICAgIGV4cGVjdChyZXNwb25zZS50b2tlblR5cGUpLnRvQmUoJ2JlYXJlcicpO1xuICAgIGV4cGVjdChyZXNwb25zZS5pc3N1ZWRBdCkudG9CZVRydXRoeSgpO1xuICAgIGV4cGVjdChyZXNwb25zZS5pc1ZhbGlkKDApKS50b0JlKGZhbHNlKTtcbiAgICBleHBlY3QocmVzcG9uc2UucmVmcmVzaFRva2VuKS50b0JlRmFsc3koKTtcbiAgICBleHBlY3QocmVzcG9uc2Uuc2NvcGUpLnRvQmVGYWxzeSgpO1xuICB9KTtcblxuICBpdCgnVGVzdCByZXNwb25zZSByZWZyZXNoIHRva2VuIHZhbGlkaXR5JywgKCkgPT4ge1xuICAgIGxldCByZXNwb25zZSA9IG5ldyBUb2tlblJlc3BvbnNlKHtcbiAgICAgIGFjY2Vzc190b2tlbjogYWNjZXNzVG9rZW4sXG4gICAgICB0b2tlbl90eXBlOiAnYmVhcmVyJyxcbiAgICAgIGV4cGlyZXNfaW46ICczMDAnLFxuICAgICAgcmVmcmVzaF90b2tlbjogcmVmcmVzaFRva2VuLFxuICAgICAgcmVmcmVzaF9leHBpcmVzX2luOiAnMTgwMCcsXG4gICAgICBzY29wZTogdW5kZWZpbmVkLFxuICAgICAgaWRfdG9rZW46IGlkVG9rZW4sXG4gICAgICBpc3N1ZWRfYXQ6IDFcbiAgICB9KTtcblxuICAgIGV4cGVjdChyZXNwb25zZSkubm90LnRvQmVOdWxsKCk7XG4gICAgZXhwZWN0KHJlc3BvbnNlLmFjY2Vzc1Rva2VuKS50b0JlKGFjY2Vzc1Rva2VuKTtcbiAgICBleHBlY3QocmVzcG9uc2UuaWRUb2tlbikudG9CZShpZFRva2VuKTtcbiAgICBleHBlY3QocmVzcG9uc2UudG9rZW5UeXBlKS50b0JlKCdiZWFyZXInKTtcbiAgICBleHBlY3QocmVzcG9uc2UuaXNzdWVkQXQpLnRvQmVUcnV0aHkoKTtcbiAgICBleHBlY3QocmVzcG9uc2UuaXNWYWxpZCgwKSkudG9CZShmYWxzZSk7XG4gICAgZXhwZWN0KHJlc3BvbnNlLnJlZnJlc2hUb2tlbikudG9CZShyZWZyZXNoVG9rZW4pO1xuICAgIGV4cGVjdChyZXNwb25zZS5pc1JlZnJlc2hUb2tlblZhbGlkKDApKS50b0JlKGZhbHNlKTtcbiAgICBleHBlY3QocmVzcG9uc2Uuc2NvcGUpLnRvQmVGYWxzeSgpO1xuICB9KTtcblxuICBpdCgnVG8gSnNvbigpIGFuZCBmcm9tIEpzb24oKSBzaG91bGQgd29yaycsICgpID0+IHtcbiAgICBsZXQgcmVzcG9uc2UgPSBuZXcgVG9rZW5SZXNwb25zZSh7YWNjZXNzX3Rva2VuOiBhY2Nlc3NUb2tlbiwgaWRfdG9rZW46IGlkVG9rZW59KTtcbiAgICBsZXQganNvbiA9IEpTT04ucGFyc2UoSlNPTi5zdHJpbmdpZnkocmVzcG9uc2UudG9Kc29uKCkpKTtcbiAgICBsZXQgbmV3UmVzcG9uc2UgPSBuZXcgVG9rZW5SZXNwb25zZShqc29uKTtcbiAgICBleHBlY3QobmV3UmVzcG9uc2UpLm5vdC50b0JlTnVsbCgpO1xuICAgIGV4cGVjdChuZXdSZXNwb25zZS5hY2Nlc3NUb2tlbikudG9CZShhY2Nlc3NUb2tlbik7XG4gICAgZXhwZWN0KG5ld1Jlc3BvbnNlLmlkVG9rZW4pLnRvQmUoaWRUb2tlbik7XG4gICAgZXhwZWN0KG5ld1Jlc3BvbnNlLnRva2VuVHlwZSkudG9CZSgnYmVhcmVyJyk7XG4gICAgZXhwZWN0KG5ld1Jlc3BvbnNlLmlzc3VlZEF0KS50b0JlVHJ1dGh5KCk7XG4gICAgZXhwZWN0KG5ld1Jlc3BvbnNlLmlzVmFsaWQoKSkudG9CZSh0cnVlKTtcbiAgICBleHBlY3QobmV3UmVzcG9uc2UucmVmcmVzaFRva2VuKS50b0JlRmFsc3koKTtcbiAgICBleHBlY3QobmV3UmVzcG9uc2Uuc2NvcGUpLnRvQmVGYWxzeSgpO1xuICB9KTtcblxuICBpdCgnQmFzaWMgVG9rZW4gRXJyb3IgVGVzdHMnLCAoKSA9PiB7XG4gICAgbGV0IGVycm9yID0gbmV3IFRva2VuRXJyb3Ioe2Vycm9yOiAnaW52YWxpZF9jbGllbnQnfSk7XG4gICAgZXhwZWN0KGVycm9yKS50b0JlVHJ1dGh5KCk7XG4gICAgZXhwZWN0KGVycm9yLmVycm9yKS50b0JlKCdpbnZhbGlkX2NsaWVudCcpO1xuICAgIGV4cGVjdChlcnJvci5lcnJvckRlc2NyaXB0aW9uKS50b0JlRmFsc3koKTtcbiAgICBleHBlY3QoZXJyb3IuZXJyb3JVcmkpLnRvQmVGYWxzeSgpO1xuICB9KTtcblxuICBpdCgnVG8gSnNvbiBhbmQgZnJvbSBKU09OIHNob3VsZCB3b3JrIGZvciBlcnJvcnMnLCAoKSA9PiB7XG4gICAgbGV0IGVycm9yID0gbmV3IFRva2VuRXJyb3Ioe2Vycm9yOiAnaW52YWxpZF9jbGllbnQnfSk7XG4gICAgbGV0IGpzb24gPSBKU09OLnBhcnNlKEpTT04uc3RyaW5naWZ5KGVycm9yLnRvSnNvbigpKSk7XG4gICAgbGV0IG5ld0Vycm9yID0gbmV3IFRva2VuRXJyb3IoanNvbik7XG4gICAgZXhwZWN0KG5ld0Vycm9yKS50b0JlVHJ1dGh5KCk7XG4gICAgZXhwZWN0KG5ld0Vycm9yLmVycm9yKS50b0JlKCdpbnZhbGlkX2NsaWVudCcpO1xuICAgIGV4cGVjdChuZXdFcnJvci5lcnJvckRlc2NyaXB0aW9uKS50b0JlRmFsc3koKTtcbiAgICBleHBlY3QobmV3RXJyb3IuZXJyb3JVcmkpLnRvQmVGYWxzeSgpO1xuICB9KTtcbn0pO1xuIl19