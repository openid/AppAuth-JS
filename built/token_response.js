"use strict";
/*
 * Copyright 2017 Google Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License"); you may not use this file except
 * in compliance with the License. You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software distributed under the
 * License is distributed on an "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either
 * express or implied. See the License for the specific language governing permissions and
 * limitations under the License.
 */
Object.defineProperty(exports, "__esModule", { value: true });
/**
 * Returns the instant of time in seconds.
 */
var nowInSeconds = function () { return Math.round(new Date().getTime() / 1000); };
/**
 * Represents the Token Response type.
 * For more information look at:
 * https://tools.ietf.org/html/rfc6749#section-5.1
 * and
 * https://openid.net/specs/openid-connect-core-1_0.html#TokenResponse
 */
var TokenResponse = /** @class */ (function () {
    function TokenResponse(accessToken, idToken, refreshToken, scope, tokenType, issuedAt, expiresIn) {
        if (tokenType === void 0) { tokenType = 'bearer'; }
        if (issuedAt === void 0) { issuedAt = nowInSeconds(); }
        this.accessToken = accessToken;
        this.idToken = idToken;
        this.refreshToken = refreshToken;
        this.scope = scope;
        this.tokenType = tokenType;
        this.issuedAt = issuedAt;
        this.expiresIn = expiresIn;
    }
    TokenResponse.prototype.toJson = function () {
        return {
            access_token: this.accessToken,
            id_token: this.idToken,
            refresh_token: this.refreshToken,
            scope: this.scope,
            token_type: this.tokenType,
            issued_at: this.issuedAt,
            expires_in: this.expiresIn
        };
    };
    TokenResponse.prototype.isValid = function () {
        if (this.expiresIn) {
            var now = nowInSeconds();
            return now < this.issuedAt + this.expiresIn;
        }
        else {
            return true;
        }
    };
    TokenResponse.fromJson = function (input) {
        var issuedAt = !input.issued_at ? nowInSeconds() : input.issued_at;
        return new TokenResponse(input.access_token, input.id_token, input.refresh_token, input.scope, input.token_type, issuedAt, input.expires_in);
    };
    return TokenResponse;
}());
exports.TokenResponse = TokenResponse;
/**
 * Represents the Token Error type.
 * For more information look at:
 * https://tools.ietf.org/html/rfc6749#section-5.2
 */
var TokenError = /** @class */ (function () {
    function TokenError(error, errorDescription, errorUri) {
        this.error = error;
        this.errorDescription = errorDescription;
        this.errorUri = errorUri;
    }
    TokenError.prototype.toJson = function () {
        return {
            error: this.error, error_description: this.errorDescription, error_uri: this.errorUri
        };
    };
    TokenError.fromJson = function (input) {
        return new TokenError(input.error, input.error_description, input.error_uri);
    };
    return TokenError;
}());
exports.TokenError = TokenError;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoidG9rZW5fcmVzcG9uc2UuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi9zcmMvdG9rZW5fcmVzcG9uc2UudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IjtBQUFBOzs7Ozs7Ozs7Ozs7R0FZRzs7QUF3Q0g7O0dBRUc7QUFDSCxJQUFNLFlBQVksR0FBRyxjQUFNLE9BQUEsSUFBSSxDQUFDLEtBQUssQ0FBQyxJQUFJLElBQUksRUFBRSxDQUFDLE9BQU8sRUFBRSxHQUFHLElBQUksQ0FBQyxFQUF2QyxDQUF1QyxDQUFDO0FBRW5FOzs7Ozs7R0FNRztBQUNIO0lBQ0UsdUJBQ1csV0FBbUIsRUFDbkIsT0FBZSxFQUNmLFlBQXFCLEVBQ3JCLEtBQWMsRUFDZCxTQUErQixFQUMvQixRQUFpQyxFQUNqQyxTQUFrQjtRQUZsQiwwQkFBQSxFQUFBLG9CQUErQjtRQUMvQix5QkFBQSxFQUFBLFdBQW1CLFlBQVksRUFBRTtRQUxqQyxnQkFBVyxHQUFYLFdBQVcsQ0FBUTtRQUNuQixZQUFPLEdBQVAsT0FBTyxDQUFRO1FBQ2YsaUJBQVksR0FBWixZQUFZLENBQVM7UUFDckIsVUFBSyxHQUFMLEtBQUssQ0FBUztRQUNkLGNBQVMsR0FBVCxTQUFTLENBQXNCO1FBQy9CLGFBQVEsR0FBUixRQUFRLENBQXlCO1FBQ2pDLGNBQVMsR0FBVCxTQUFTLENBQVM7SUFBRyxDQUFDO0lBRWpDLDhCQUFNLEdBQU47UUFDRSxNQUFNLENBQUM7WUFDTCxZQUFZLEVBQUUsSUFBSSxDQUFDLFdBQVc7WUFDOUIsUUFBUSxFQUFFLElBQUksQ0FBQyxPQUFPO1lBQ3RCLGFBQWEsRUFBRSxJQUFJLENBQUMsWUFBWTtZQUNoQyxLQUFLLEVBQUUsSUFBSSxDQUFDLEtBQUs7WUFDakIsVUFBVSxFQUFFLElBQUksQ0FBQyxTQUFTO1lBQzFCLFNBQVMsRUFBRSxJQUFJLENBQUMsUUFBUTtZQUN4QixVQUFVLEVBQUUsSUFBSSxDQUFDLFNBQVM7U0FDM0IsQ0FBQztJQUNKLENBQUM7SUFFRCwrQkFBTyxHQUFQO1FBQ0UsRUFBRSxDQUFDLENBQUMsSUFBSSxDQUFDLFNBQVMsQ0FBQyxDQUFDLENBQUM7WUFDbkIsSUFBSSxHQUFHLEdBQUcsWUFBWSxFQUFFLENBQUM7WUFDekIsTUFBTSxDQUFDLEdBQUcsR0FBRyxJQUFJLENBQUMsUUFBUSxHQUFHLElBQUksQ0FBQyxTQUFTLENBQUM7UUFDOUMsQ0FBQztRQUFDLElBQUksQ0FBQyxDQUFDO1lBQ04sTUFBTSxDQUFDLElBQUksQ0FBQztRQUNkLENBQUM7SUFDSCxDQUFDO0lBRU0sc0JBQVEsR0FBZixVQUFnQixLQUF3QjtRQUN0QyxJQUFNLFFBQVEsR0FBRyxDQUFDLEtBQUssQ0FBQyxTQUFTLENBQUMsQ0FBQyxDQUFDLFlBQVksRUFBRSxDQUFDLENBQUMsQ0FBQyxLQUFLLENBQUMsU0FBUyxDQUFDO1FBQ3JFLE1BQU0sQ0FBQyxJQUFJLGFBQWEsQ0FDcEIsS0FBSyxDQUFDLFlBQVksRUFDbEIsS0FBSyxDQUFDLFFBQVEsRUFDZCxLQUFLLENBQUMsYUFBYSxFQUNuQixLQUFLLENBQUMsS0FBSyxFQUNYLEtBQUssQ0FBQyxVQUFVLEVBQ2hCLFFBQVEsRUFDUixLQUFLLENBQUMsVUFBVSxDQUFDLENBQUE7SUFDdkIsQ0FBQztJQUNILG9CQUFDO0FBQUQsQ0FBQyxBQTFDRCxJQTBDQztBQTFDWSxzQ0FBYTtBQTRDMUI7Ozs7R0FJRztBQUNIO0lBQ0Usb0JBQ29CLEtBQWdCLEVBQ2hCLGdCQUF5QixFQUN6QixRQUFpQjtRQUZqQixVQUFLLEdBQUwsS0FBSyxDQUFXO1FBQ2hCLHFCQUFnQixHQUFoQixnQkFBZ0IsQ0FBUztRQUN6QixhQUFRLEdBQVIsUUFBUSxDQUFTO0lBQUcsQ0FBQztJQUV6QywyQkFBTSxHQUFOO1FBQ0UsTUFBTSxDQUFDO1lBQ0wsS0FBSyxFQUFFLElBQUksQ0FBQyxLQUFLLEVBQUUsaUJBQWlCLEVBQUUsSUFBSSxDQUFDLGdCQUFnQixFQUFFLFNBQVMsRUFBRSxJQUFJLENBQUMsUUFBUTtTQUN0RixDQUFBO0lBQ0gsQ0FBQztJQUVNLG1CQUFRLEdBQWYsVUFBZ0IsS0FBcUI7UUFDbkMsTUFBTSxDQUFDLElBQUksVUFBVSxDQUFDLEtBQUssQ0FBQyxLQUFLLEVBQUUsS0FBSyxDQUFDLGlCQUFpQixFQUFFLEtBQUssQ0FBQyxTQUFTLENBQUMsQ0FBQztJQUMvRSxDQUFDO0lBQ0gsaUJBQUM7QUFBRCxDQUFDLEFBZkQsSUFlQztBQWZZLGdDQUFVIiwic291cmNlc0NvbnRlbnQiOlsiLypcclxuICogQ29weXJpZ2h0IDIwMTcgR29vZ2xlIEluYy5cclxuICpcclxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTsgeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHRcclxuICogaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcclxuICpcclxuICogaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXHJcbiAqXHJcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmUgZGlzdHJpYnV0ZWQgdW5kZXIgdGhlXHJcbiAqIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLCBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyXHJcbiAqIGV4cHJlc3Mgb3IgaW1wbGllZC4gU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxyXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cclxuICovXHJcblxyXG4vKipcclxuICogUmVwcmVzZW50cyB0aGUgYWNjZXNzIHRva2VuIHR5cGVzLlxyXG4gKiBGb3IgbW9yZSBpbmZvcm1hdGlvbiBzZWU6XHJcbiAqIGh0dHBzOi8vdG9vbHMuaWV0Zi5vcmcvaHRtbC9yZmM2NzQ5I3NlY3Rpb24tNy4xXHJcbiAqL1xyXG5leHBvcnQgdHlwZSBUb2tlblR5cGUgPSAnYmVhcmVyJ3wnbWFjJztcclxuXHJcbi8qKlxyXG4gKiBSZXByZXNlbnRzIHRoZSBUb2tlblJlc3BvbnNlIGFzIGEgSlNPTiBPYmplY3QuXHJcbiAqL1xyXG5leHBvcnQgaW50ZXJmYWNlIFRva2VuUmVzcG9uc2VKc29uIHtcclxuICBhY2Nlc3NfdG9rZW46IHN0cmluZztcclxuICBpZF90b2tlbjogc3RyaW5nOyAgICAgICAvKiBpZF90b2tlbiBNVVNUIGJlIGluY2x1ZGVkIGluIHRoZSByZXNwb25zZVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgIGh0dHBzOi8vb3BlbmlkLm5ldC9zcGVjcy9vcGVuaWQtY29ubmVjdC1jb3JlLTFfMC5odG1sI1Rva2VuUmVzcG9uc2UgKi9cclxuICB0b2tlbl90eXBlPzogVG9rZW5UeXBlOyAvKiB0cmVhdGluZyB0b2tlbiB0eXBlIGFzIG9wdGlvbmFsLCBhcyBpdHMgZ29pbmcgdG8gYmUgaW5mZXJyZWQuICovXHJcbiAgaXNzdWVkX2F0PzogbnVtYmVyOyAgICAgLyogd2hlbiB3YXMgaXQgaXNzdWVkID8gKi9cclxuICBleHBpcmVzX2luPzogbnVtYmVyOyAgICAvKiBsaWZldGltZSBpbiBzZWNvbmRzLiAqL1xyXG4gIHJlZnJlc2hfdG9rZW4/OiBzdHJpbmc7XHJcbiAgc2NvcGU/OiBzdHJpbmc7XHJcbn1cclxuXHJcbi8qKlxyXG4gKiBSZXByZXNlbnRzIHRoZSBwb3NzaWJsZSBlcnJvciBjb2RlcyBmcm9tIHRoZSB0b2tlbiBlbmRwb2ludC5cclxuICogRm9yIG1vcmUgaW5mb3JtYXRpb24gbG9vayBhdDpcclxuICogaHR0cHM6Ly90b29scy5pZXRmLm9yZy9odG1sL3JmYzY3NDkjc2VjdGlvbi01LjJcclxuICovXHJcbmV4cG9ydCB0eXBlIEVycm9yVHlwZSA9ICdpbnZhbGlkX3JlcXVlc3QnfCdpbnZhbGlkX2NsaWVudCd8J2ludmFsaWRfZ3JhbnQnfCd1bmF1dGhvcml6ZWRfY2xpZW50J3xcclxuICAgICd1bnN1cHBvcnRlZF9ncmFudF90eXBlJ3wnaW52YWxpZF9zY29wZSc7XHJcblxyXG4vKipcclxuICogUmVwcmVzZW50cyB0aGUgVG9rZW5FcnJvciBhcyBhIEpTT04gT2JqZWN0LlxyXG4gKi9cclxuZXhwb3J0IGludGVyZmFjZSBUb2tlbkVycm9ySnNvbiB7XHJcbiAgZXJyb3I6IEVycm9yVHlwZTtcclxuICBlcnJvcl9kZXNjcmlwdGlvbj86IHN0cmluZztcclxuICBlcnJvcl91cmk/OiBzdHJpbmc7XHJcbn1cclxuXHJcbi8qKlxyXG4gKiBSZXR1cm5zIHRoZSBpbnN0YW50IG9mIHRpbWUgaW4gc2Vjb25kcy5cclxuICovXHJcbmNvbnN0IG5vd0luU2Vjb25kcyA9ICgpID0+IE1hdGgucm91bmQobmV3IERhdGUoKS5nZXRUaW1lKCkgLyAxMDAwKTtcclxuXHJcbi8qKlxyXG4gKiBSZXByZXNlbnRzIHRoZSBUb2tlbiBSZXNwb25zZSB0eXBlLlxyXG4gKiBGb3IgbW9yZSBpbmZvcm1hdGlvbiBsb29rIGF0OlxyXG4gKiBodHRwczovL3Rvb2xzLmlldGYub3JnL2h0bWwvcmZjNjc0OSNzZWN0aW9uLTUuMVxyXG4gKiBhbmRcclxuICogaHR0cHM6Ly9vcGVuaWQubmV0L3NwZWNzL29wZW5pZC1jb25uZWN0LWNvcmUtMV8wLmh0bWwjVG9rZW5SZXNwb25zZVxyXG4gKi9cclxuZXhwb3J0IGNsYXNzIFRva2VuUmVzcG9uc2Uge1xyXG4gIGNvbnN0cnVjdG9yKFxyXG4gICAgICBwdWJsaWMgYWNjZXNzVG9rZW46IHN0cmluZyxcclxuICAgICAgcHVibGljIGlkVG9rZW46IHN0cmluZyxcclxuICAgICAgcHVibGljIHJlZnJlc2hUb2tlbj86IHN0cmluZyxcclxuICAgICAgcHVibGljIHNjb3BlPzogc3RyaW5nLFxyXG4gICAgICBwdWJsaWMgdG9rZW5UeXBlOiBUb2tlblR5cGUgPSAnYmVhcmVyJyxcclxuICAgICAgcHVibGljIGlzc3VlZEF0OiBudW1iZXIgPSBub3dJblNlY29uZHMoKSxcclxuICAgICAgcHVibGljIGV4cGlyZXNJbj86IG51bWJlcikge31cclxuXHJcbiAgdG9Kc29uKCk6IFRva2VuUmVzcG9uc2VKc29uIHtcclxuICAgIHJldHVybiB7XHJcbiAgICAgIGFjY2Vzc190b2tlbjogdGhpcy5hY2Nlc3NUb2tlbixcclxuICAgICAgaWRfdG9rZW46IHRoaXMuaWRUb2tlbixcclxuICAgICAgcmVmcmVzaF90b2tlbjogdGhpcy5yZWZyZXNoVG9rZW4sXHJcbiAgICAgIHNjb3BlOiB0aGlzLnNjb3BlLFxyXG4gICAgICB0b2tlbl90eXBlOiB0aGlzLnRva2VuVHlwZSxcclxuICAgICAgaXNzdWVkX2F0OiB0aGlzLmlzc3VlZEF0LFxyXG4gICAgICBleHBpcmVzX2luOiB0aGlzLmV4cGlyZXNJblxyXG4gICAgfTtcclxuICB9XHJcblxyXG4gIGlzVmFsaWQoKTogYm9vbGVhbiB7XHJcbiAgICBpZiAodGhpcy5leHBpcmVzSW4pIHtcclxuICAgICAgbGV0IG5vdyA9IG5vd0luU2Vjb25kcygpO1xyXG4gICAgICByZXR1cm4gbm93IDwgdGhpcy5pc3N1ZWRBdCArIHRoaXMuZXhwaXJlc0luO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgcmV0dXJuIHRydWU7XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICBzdGF0aWMgZnJvbUpzb24oaW5wdXQ6IFRva2VuUmVzcG9uc2VKc29uKTogVG9rZW5SZXNwb25zZSB7XHJcbiAgICBjb25zdCBpc3N1ZWRBdCA9ICFpbnB1dC5pc3N1ZWRfYXQgPyBub3dJblNlY29uZHMoKSA6IGlucHV0Lmlzc3VlZF9hdDtcclxuICAgIHJldHVybiBuZXcgVG9rZW5SZXNwb25zZShcclxuICAgICAgICBpbnB1dC5hY2Nlc3NfdG9rZW4sXHJcbiAgICAgICAgaW5wdXQuaWRfdG9rZW4sXHJcbiAgICAgICAgaW5wdXQucmVmcmVzaF90b2tlbixcclxuICAgICAgICBpbnB1dC5zY29wZSxcclxuICAgICAgICBpbnB1dC50b2tlbl90eXBlLFxyXG4gICAgICAgIGlzc3VlZEF0LFxyXG4gICAgICAgIGlucHV0LmV4cGlyZXNfaW4pXHJcbiAgfVxyXG59XHJcblxyXG4vKipcclxuICogUmVwcmVzZW50cyB0aGUgVG9rZW4gRXJyb3IgdHlwZS5cclxuICogRm9yIG1vcmUgaW5mb3JtYXRpb24gbG9vayBhdDpcclxuICogaHR0cHM6Ly90b29scy5pZXRmLm9yZy9odG1sL3JmYzY3NDkjc2VjdGlvbi01LjJcclxuICovXHJcbmV4cG9ydCBjbGFzcyBUb2tlbkVycm9yIHtcclxuICBjb25zdHJ1Y3RvcihcclxuICAgICAgcHVibGljIHJlYWRvbmx5IGVycm9yOiBFcnJvclR5cGUsXHJcbiAgICAgIHB1YmxpYyByZWFkb25seSBlcnJvckRlc2NyaXB0aW9uPzogc3RyaW5nLFxyXG4gICAgICBwdWJsaWMgcmVhZG9ubHkgZXJyb3JVcmk/OiBzdHJpbmcpIHt9XHJcblxyXG4gIHRvSnNvbigpOiBUb2tlbkVycm9ySnNvbiB7XHJcbiAgICByZXR1cm4ge1xyXG4gICAgICBlcnJvcjogdGhpcy5lcnJvciwgZXJyb3JfZGVzY3JpcHRpb246IHRoaXMuZXJyb3JEZXNjcmlwdGlvbiwgZXJyb3JfdXJpOiB0aGlzLmVycm9yVXJpXHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICBzdGF0aWMgZnJvbUpzb24oaW5wdXQ6IFRva2VuRXJyb3JKc29uKSB7XHJcbiAgICByZXR1cm4gbmV3IFRva2VuRXJyb3IoaW5wdXQuZXJyb3IsIGlucHV0LmVycm9yX2Rlc2NyaXB0aW9uLCBpbnB1dC5lcnJvcl91cmkpO1xyXG4gIH1cclxufVxyXG4iXX0=